{% from 'simple/macros.html' import result_header, result_sub_header, result_sub_footer, result_footer with context %}

{{ result_header(result, favicons, image_proxify) }}
{{ result_sub_header(result) }}
{% if result.iframe_src -%}
<p class="altlink"> <a class="btn-collapse collapsed media-loader disabled_if_nojs" data-target="#result-video-{{ index }}" data-btn-text-collapsed="{{ _('show video') }}" data-btn-text-not-collapsed="{{ _('hide video') }}">{{ icon_small('film') }} {{ _('show video') }}</a></p>
{%- endif %}
{%- if result.content %}
  <p class="content">
    {{ result.content|safe }}
  </p>
{%- else %}
  <p class="content empty_element">
    {{ _('This site did not provide any description.')|safe }}
  </p>
{% endif -%}
</p>
{{- result_sub_footer(result) -}}
{% if result.iframe_src -%}
<div id="result-video-{{ index }}" class="embedded-video invisible">
  {%- set iframe_src_str = result.iframe_src|string|default('') -%}
  {%- if iframe_src_str and 'youtube-nocookie.com/embed' in iframe_src_str -%}
  <!-- YouTube videos: Show thumbnail + button instead of iframe to avoid YouTube Error 153 -->
  <div style="position: relative; width: 100%; aspect-ratio: 16 / 9; padding: 10px 0 0 0; background: #000; min-height: 400px;">
    {% if result.thumbnail -%}
    <img src="{{result.thumbnail}}" alt="{{result.title}}" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.85; display: block;">
    {%- endif %}
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10;">
      <a href="{{result.url}}" target="_blank" rel="noopener noreferrer" style="background: #ff0000; color: #ffffff !important; padding: 16px 32px; font-size: 20px; font-weight: bold; text-decoration: none; border-radius: 6px; cursor: pointer; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6); display: inline-block; transition: background 0.2s;">Watch on YouTube</a>
    </div>
  </div>
  {%- else -%}
  <!-- Non-YouTube videos: Use normal iframe embed -->
  <div class="video-container" style="position: relative; width: 100%; aspect-ratio: 16 / 9; padding: 10px 0 0 0;">
    <iframe data-src="{{result.iframe_src}}" frameborder="0" allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
  </div>
  {%- endif %}
</div>
{%- endif %}
{{ result_footer(result) }}
